<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>LTL: Command Line and Config File Interfacing</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="ltl_doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">LTL
   &#160;<span id="projectnumber">2.0.x</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Command Line and Config File Interfacing<div class="ingroups"><a class="el" href="a00012.html">The Utility Library</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00024.html">util::CommandLineReader</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Implementation of an <a class="el" href="a00104.html" title="An abstract base class for sources feeding into util::OptionParser . ">util::OptionReader</a> for command line processing.  <a href="a00024.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00025.html">util::ConfigFileReader</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Implementation of an <a class="el" href="a00104.html" title="An abstract base class for sources feeding into util::OptionParser . ">OptionReader</a> for config file processing.  <a href="a00025.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00102.html">util::Option</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">The base class for all options.  <a href="a00102.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00074.html">util::IntOption</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Hold an integer number.  <a href="a00074.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00055.html">util::FloatOption</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Hold a single precision number.  <a href="a00055.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00035.html">util::DoubleOption</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Hold a double precision number.  <a href="a00035.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00020.html">util::BoolOption</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Hold a boolean. Default value is toggled when the option is given.  <a href="a00020.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00124.html">util::StringOption</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Hold a string.  <a href="a00124.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00054.html">util::FloatArrayOption</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Hold an array of N floats.  <a href="a00054.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00034.html">util::DoubleArrayOption</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Hold an array of N doubles.  <a href="a00034.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00073.html">util::IntArrayOption</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Hold an array of N ints.  <a href="a00073.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00121.html">util::StringArrayOption</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00118.html">util::RegionArrayOption</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Hold a N-dim <code><a class="el" href="a00117.html" title="To represent geometries or subarrays of N-dimensional arrays. ">Region</a></code>.  <a href="a00118.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00103.html">util::OptionParser</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generic parser object for options.  <a href="a00103.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00104.html">util::OptionReader</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">An <b>abstract</b> base class for sources feeding into <a class="el" href="a00103.html" title="Generic parser object for options. ">util::OptionParser</a> .  <a href="a00104.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga10ef2be338dcd0282f5548f8753f4cb6"><td class="memItemLeft" align="right" valign="top">ostream &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00228.html#ga10ef2be338dcd0282f5548f8753f4cb6">operator&lt;&lt;</a> (ostream &amp;os, Option &amp;op)</td></tr>
<tr class="separator:ga10ef2be338dcd0282f5548f8753f4cb6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga82ed158a38c072502f882c65bf32ebcf"><td class="memItemLeft" align="right" valign="top">ostream &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00228.html#ga82ed158a38c072502f882c65bf32ebcf">operator&lt;&lt;</a> (ostream &amp;os, const OptionParser &amp;op)</td></tr>
<tr class="separator:ga82ed158a38c072502f882c65bf32ebcf"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>The option parsing library consists of a set of classes derived from <code><a class="el" href="a00102.html" title="The base class for all options. ">util::Option</a></code> which describe the types of the options the program accepts, for example a string, a float, an array of floats, etc.</p>
<p>There are two option readers, one constructing a list of options from the command line, the <code><a class="el" href="a00024.html" title="Implementation of an util::OptionReader for command line processing. ">util::CommandLineReader</a></code>, and one constructing a list of options from a file, the <code><a class="el" href="a00025.html" title="Implementation of an OptionReader for config file processing. ">util::ConfigFileReader</a></code>. Both are derived from the generic <code><a class="el" href="a00104.html" title="An abstract base class for sources feeding into util::OptionParser . ">util::OptionReader</a></code>. They can also be used in combination, i.e. reading options from a file and allowing the user to override values via the command line. The example code below should make things clear.</p>
<p>When using the option parsing library, the first thing to do is to tell it what options a program accepts. This is done by adding <code><a class="el" href="a00102.html" title="The base class for all options. ">Option</a></code> objects to an instance of <code><a class="el" href="a00103.html" title="Generic parser object for options. ">OptionParser</a></code>. Each option will have a data type, and will hold a long option name (used on the command line with &ndash;long-option [value], an optional short option form (e.g. -l), a default value, and, optionally, a pointer to the data type where the option will store its value (a pointer to, e.g., a global variable, or a member of a struct.</p>
<p>Next, a program would tell the <code><a class="el" href="a00103.html" title="Generic parser object for options. ">OptionParser</a></code> to parse the options it was given on the command line or in the config file. The <code><a class="el" href="a00103.html" title="Generic parser object for options. ">OptionParser</a></code> uses an <code><a class="el" href="a00104.html" title="An abstract base class for sources feeding into util::OptionParser . ">OptionReader</a></code> to do the actual reading. The values can then be probed using <code><a class="el" href="a00103.html#a08c00d7e545ca61b880580c465d7600c" title="retrieve an option by its name. ">OptionParser::getOption()</a></code>.</p>
<p>Any arguments passed on the command line without a preceding '-' or '&ndash;' <em>AFTER</em> the last option are considered "file name arguments" and can be retrieved from the <code><a class="el" href="a00024.html" title="Implementation of an util::OptionReader for command line processing. ">CommandLineReader</a></code> using <code><a class="el" href="a00024.html#ada6b00b32be75472e0bfe0a73206e48d">CommandLineReader::fileArguments()</a></code>.</p>
<p>The command line syntax is as follows: &ndash;long-name or -s, arguments separated by a space from the option, array arguments separated by commas without space. Bool flags toggle their default value.</p>
<pre class="fragment">  program --find-things --this-number 2.0 --array 1,2,3 -v 5.0 -s hello file1 file2 file3</pre><p>In a config file, the syntax is long-option-name = value. '#' is the comment character. Value syntax the same as for the command line.</p>
<pre class="fragment"> find-things  = TRUE   # true|false|TRUE|FALSE for bool options
 this-number  = 2.0    # a float option
 array        = 1,2,3  # an integer array
 value        = 5.0    # another float, -v is short form, in the file we give the long name
 string       = hello  # -s was the short form</pre><p>This config file can then be used together with the command line like this:</p>
<pre class="fragment">  program --config-file program.conf --find-things --array 5,6,7 file1 file2 file3</pre><p> So that the program will find <code>&ndash;find-things</code> to be FALSE and array to be 5,6,7 (both overridden on the command line) and the remaining options as given in the config file.</p>
<p>The <code><a class="el" href="a00103.html#abe78fa6dd22b8abc01677d31e70d5a78">OptionParser::printUsage()</a></code> method generates properly formatted and annotated usage information: </p>
<pre class="fragment"> -h, --help &lt;FLAG&gt;                    [FALSE]
     Print usage information.

 -e, --expr &lt;STRING&gt;                  []
     The expression to evaluate. Mandatory. Function and variable
     names are case insensitive. The file operands are assigned to
     the variables in the expression in order.

 -o, --outfile &lt;STRING&gt;               [test.fits]
     Output filename.
 ...
</pre><p>To make everything clear, here is an example using just the command line.</p>
<div class="fragment"><div class="line">*  <span class="comment">// globals</span></div>
<div class="line">*  <span class="keywordtype">bool</span> help;</div>
<div class="line">*  <span class="keywordtype">string</span> outfile;</div>
<div class="line">*  <span class="keywordtype">int</span>    size[3];</div>
<div class="line">*  CommandLineReader comline(argc, argv); <span class="comment">// read from command line</span></div>
<div class="line">*  OptionParser flags(&amp;comline);</div>
<div class="line">*  <span class="comment">//                  type       --name    default  description             -short   ptr to value (optional)</span></div>
<div class="line">*  flags.addOption(<span class="keyword">new</span> BoolOption(<span class="stringliteral">&quot;help&quot;</span>, <span class="stringliteral">&quot;FALSE&quot;</span>, <span class="stringliteral">&quot;Print usage information.&quot;</span>, <span class="charliteral">&#39;h&#39;</span>, &amp;help) );</div>
<div class="line">*  flags.addOption(<span class="keyword">new</span> StringOption(<span class="stringliteral">&quot;outfile&quot;</span>, <span class="stringliteral">&quot;test.fits&quot;</span>, <span class="stringliteral">&quot;Output filename.&quot;</span>, <span class="charliteral">&#39;o&#39;</span>, &amp;outfile) );</div>
<div class="line">*  flags.addOption(<span class="keyword">new</span> IntArrayOption(<span class="stringliteral">&quot;size&quot;</span>, <span class="stringliteral">&quot;0,0,0&quot;</span>, <span class="stringliteral">&quot;Size array&quot;</span>, <span class="charliteral">&#39;s&#39;</span>, 3, &amp;size[0]) );</div>
<div class="line">*</div>
<div class="line">*  flags.parseOptions();</div>
<div class="line">*  list&lt;string&gt; files = comline.fileArguments(); <span class="comment">// get the filenames</span></div>
<div class="line">*  </div>
</div><!-- fragment --><p>Finally, here is a more complex example using first a config file and then allowing options to be overridden by the command line.</p>
<div class="fragment"><div class="line">*  <span class="comment">// globals</span></div>
<div class="line">*  <span class="keywordtype">bool</span> help;</div>
<div class="line">*  <span class="keywordtype">string</span> outfile;</div>
<div class="line">*  <span class="keywordtype">int</span>    size[3];</div>
<div class="line">*</div>
<div class="line">*  <span class="keywordtype">string</span> cf = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line">*  <span class="comment">// config file name should be the first command line argument:</span></div>
<div class="line">*  <span class="keywordflow">if</span>( argc &gt;= 3 &amp;&amp; (!strcmp(argv[1],<span class="stringliteral">&quot;--config-file&quot;</span>) || !strcmp(argv[1],<span class="stringliteral">&quot;-c&quot;</span>)) )</div>
<div class="line">*     cf = argv[2];</div>
<div class="line">*</div>
<div class="line">*  <span class="keywordflow">try</span></div>
<div class="line">*  {</div>
<div class="line">*    ConfigFileReader cfgfile( cf );</div>
<div class="line">*    OptionParser flags( &amp;cfgfile );    <span class="comment">// here we use the ConfigFileReader</span></div>
<div class="line">*</div>
<div class="line">*    <span class="comment">//                  type       --name    default  description             -short   ptr to value (optional)</span></div>
<div class="line">*    flags.addOption(<span class="keyword">new</span> BoolOption(<span class="stringliteral">&quot;help&quot;</span>, <span class="stringliteral">&quot;FALSE&quot;</span>, <span class="stringliteral">&quot;Print usage information.&quot;</span>, <span class="charliteral">&#39;h&#39;</span>, &amp;help) );</div>
<div class="line">*    flags.addOption(<span class="keyword">new</span> StringOption(<span class="stringliteral">&quot;outfile&quot;</span>, <span class="stringliteral">&quot;test.fits&quot;</span>, <span class="stringliteral">&quot;Output filename.&quot;</span>, <span class="charliteral">&#39;o&#39;</span>, &amp;outfile) );</div>
<div class="line">*    flags.addOption(<span class="keyword">new</span> IntArrayOption(<span class="stringliteral">&quot;size&quot;</span>, <span class="stringliteral">&quot;0,0,0&quot;</span>, <span class="stringliteral">&quot;Size array&quot;</span>, <span class="charliteral">&#39;s&#39;</span>, 3, &amp;size[0]) );</div>
<div class="line">*</div>
<div class="line">*    <span class="comment">// read the config file</span></div>
<div class="line">*    flags.parseOptions();</div>
<div class="line">*</div>
<div class="line">*    <span class="comment">// then try again from the command line</span></div>
<div class="line">*    CommandLineReader comline(argc, argv); <span class="comment">// read from command line</span></div>
<div class="line">*    flags.changeReader( &amp;comline );</div>
<div class="line">*    flags.parseOptions();</div>
<div class="line">*  }</div>
<div class="line">*  <span class="keywordflow">catch</span> (exception&amp; e)</div>
<div class="line">*  {</div>
<div class="line">*    flags.printUsage(cerr);</div>
<div class="line">*    <span class="keywordflow">throw</span>;</div>
<div class="line">*  }</div>
<div class="line">*  <span class="comment">// finally, retrieve the file arguments</span></div>
<div class="line">*  list&lt;string&gt; files = comline.fileArguments(); <span class="comment">// get the filenames</span></div>
<div class="line">*  </div>
</div><!-- fragment --> <h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ga10ef2be338dcd0282f5548f8753f4cb6"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">ostream &amp; operator&lt;&lt; </td>
          <td>(</td>
          <td class="paramtype">ostream &amp;&#160;</td>
          <td class="paramname"><em>os</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="a00102.html">Option</a> &amp;&#160;</td>
          <td class="paramname"><em>op</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">related</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Pretty-print the option to <em>os</em>. </p>

</div>
</div>
<a class="anchor" id="ga82ed158a38c072502f882c65bf32ebcf"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">ostream &amp; operator&lt;&lt; </td>
          <td>(</td>
          <td class="paramtype">ostream &amp;&#160;</td>
          <td class="paramname"><em>os</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="a00103.html">OptionParser</a> &amp;&#160;</td>
          <td class="paramname"><em>op</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">related</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Write options to <em>op</em>. Will pretty-print the options, their default values, and their given values to the stream: </p>
<pre class="fragment">  expr             | e |                            |
  help             | h |                      FALSE | FALSE
  outfile          | o |                  test.fits | test.fits
  propagate-errors | p |                      FALSE | FALSE
  size             | s |                      0,0,0 | 0,0,0
  verbose          | v |                      FALSE | FALSE</pre> 
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed Mar 11 2015 14:54:49 for LTL by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.5
</small></address>
</body>
</html>
